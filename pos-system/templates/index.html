<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Fast Food POS</title>
<style>
  body { font-family: Arial, sans-serif; margin: 2rem; }
  .menu { margin-bottom: 1rem; }
  button.item-btn {
    margin: 0.2rem;
    padding: 1rem 1.5rem;
    font-size: 1rem;
  }
  #order-summary {
    margin-top: 1rem;
    padding: 1rem;
    border: 1px solid #ccc;
    max-width: 400px;
  }
  #order-items {
    margin-bottom: 1rem;
  }
  #complete-btn {
    background-color: #28a745;
    color: white;
    border: none;
    padding: 0.7rem 1.2rem;
    font-size: 1.1rem;
    cursor: pointer;
  }
  #complete-btn:disabled {
    background-color: #aaa;
    cursor: not-allowed;
  }
</style>
</head>
<body>

<h1>Fast Food POS System</h1>

<div class="menu">
  <h3>Select Items:</h3>
  <button class="item-btn" data-name="Burger" data-price="5.99">Burger ($5.99)</button>
  <button class="item-btn" data-name="Fries" data-price="2.99">Fries ($2.99)</button>
  <button class="item-btn" data-name="Soda" data-price="1.50">Soda ($1.50)</button>
  <button class="item-btn" data-name="Salad" data-price="4.00">Salad ($4.00)</button>
  <button class="item-btn" data-name="Ice Cream" data-price="3.00">Ice Cream ($3.00)</button>
</div>

<div id="order-summary">
  <h3>Current Order:</h3>
  <ul id="order-items"></ul>
  <strong>Total: $<span id="order-total">0.00</span></strong>
</div>

<button id="complete-btn" disabled>Complete Order</button>

<script>
  const orderItemsElem = document.getElementById('order-items');
  const orderTotalElem = document.getElementById('order-total');
  const completeBtn = document.getElementById('complete-btn');

  let currentOrder = [];

  function updateOrderUI() {
    // Clear list
    orderItemsElem.innerHTML = '';

    // Add each item
    currentOrder.forEach((item, index) => {
      const li = document.createElement('li');
      li.textContent = `${item.name} - $${item.price.toFixed(2)}`;
      orderItemsElem.appendChild(li);
    });

    // Update total
    const total = currentOrder.reduce((sum, item) => sum + item.price, 0);
    orderTotalElem.textContent = total.toFixed(2);

    // Enable/disable Complete Order button
    completeBtn.disabled = currentOrder.length === 0;
  }

  // Add item on button click
  document.querySelectorAll('.item-btn').forEach(button => {
    button.addEventListener('click', () => {
      const name = button.dataset.name;
      const price = parseFloat(button.dataset.price);
      currentOrder.push({ name, price });
      updateOrderUI();
    });
  });

  // Handle complete order
  completeBtn.addEventListener('click', () => {
    if (currentOrder.length === 0) return;

    // Build order object with unique order_id (simple timestamp-based)
    const order = {
      order_id: `order-${Date.now()}`,
      items: currentOrder,
      total: currentOrder.reduce((sum, item) => sum + item.price, 0),
      timestamp: new Date().toISOString()
    };

    // Send order to backend API
    fetch('/order', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(order)
    })
      .then(res => {
        if (!res.ok) throw new Error('Failed to submit order');
        return res.json();
      })
      .then(data => {
        alert(data.message || 'Order completed successfully!');
        // Clear order after success
        currentOrder = [];
        updateOrderUI();
      })
      .catch(err => alert(err.message));
  });

  // Initialize UI
  updateOrderUI();
</script>

</body>
</html>
